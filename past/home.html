<!doctype html>
<html>
    <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link rel="shortcut icon" href="static/favicon.ico" />
    <title>{{ details[zid]['full_name'] }}</title>
    <style>
    .boxed {
        width: 100%;
        padding: 10px;
        border: 5px solid gray;
        margin: 0;
    }
    </style>
    </head>
    <body>
        <form method="POST">
        <nav class="navbar navbar-expand-md fixed-top navbar-dark bg-dark justify-content-between" >

            <a class="navbar-brand" href="{{url_for('index',login_zid=zid)}}"><h3>UNSWtalk</h3></a>

            <div class="form-inline">
                <a class="navbar-brand" href="{{url_for('profile',login_zid=zid,zids=zid)}}"> 
                    &#160&#160&#160&#160&#160
                    {% if zid in no_pic %}
                    <img src="/static/no_pic.png" width="40" height="40">
                    {% else %}
                    <img src="/static/{{zid}}.jpg" width="40" height="40">
                    {% endif %}
                </a>
                <a class="navbar-brand" href="{{url_for('profile',login_zid=zid,zids=zid)}}"> {{ details[zid]['full_name'] }} &#160 </a>
                <a class="navbar-brand" href="{{url_for('friend_page',login_zid=zid)}}"> Friends </a>
                <a class="navbar-brand" href="{{url_for('friend_suggestions',login_zid=zid)}}"> Friend Suggestions </a>
                <a class="navbar-brand" href="https://www.patreon.com/"> Support Us </a>
            </div>
            <div class="form-inline">
                <input class="form-control" type="text" placeholder="Search names or posts" aria-label="Search" name="search" size="50">
                <span class="input-group-btn">
                    <button class="btn btn-secondary" type="submit" name="btn" value="s_name">&#x1F50E Name</button>
                </span>
                <span class="input-group-btn">
                    <button class="btn btn-secondary" type="submit" name="btn" value="s_post">&#x1F50E Post</button>
                </span>
            </div>
                <button type="submit" class="btn btn-warning" name="btn" value="logout">Logout</button>

        </nav>
        <br><br>
               
        <div class="jumbotron">
            
            <ul class="nav nav-pills nav-fill">
                <li class="nav-item">
                {% if page_zid in no_pic %}
                    <a  href="{{url_for('profile',login_zid=zid,zids=page_zid)}}"><img src="/static/no_pic.png" width="150" height="150"></a>
                {% else %}
                    <a  href="{{url_for('profile',login_zid=zid,zids=page_zid)}}"><img src="/static/{{page_zid}}.jpg" width="150" height="150"></a>
                {% endif %}
                    <br>
                    <h3>{{ details[page_zid]['full_name'] }}'s Home Page</h3>
                </li>
            </ul>
            <hr class="my-4">
            <br>
            <div class="boxed">
                <legend>Student Details:</legend>
            <ul class="nav nav-pills nav-fill">
                {% if details[page_zid]['birthday'] %}
                <li class="nav-item">
                    <font size="4">Birthday: {{ details[page_zid]['birthday'] }}</font>
                </li>
                {% endif %}
                {% if details[page_zid]['program'] %}
                <li class="nav-item">
                    <font size="4">Program: {{ details[page_zid]['program'] }}</font>
                </li>
                {% endif %}
                {% if details[page_zid]['email'] %}
                <li class="nav-item">
                    <font size="4">Email: {{ details[page_zid]['email'] }}</font>
                </li>
                {% endif %}
            </ul>
            </div>
            {% if zid != page_zid %}
                {% if page_id not in friends[zid] %}
                <div align="right">
                    <button type="submit" class="btn btn-primary btn" name="btn" value="addfriend_{{user}}">Add as friend</button>
                </div>
                {% else %}
                <div align="right">
                    <button class="btn btn-primary btn disabled" >Already added as friend</button>
                </div>
                {% endif %}
            {% endif %}
            
            {% if profile_text %}
            <p class="lead"><font size="5">{{profile_text | safe }}</font></p><br>
            <button type="submit" class="btn btn-secondary btn-sm" name="btn" value="remove_profile_text">REMOVE</button>
            <hr class="my-4">
            {% elif page_zid == zid %}
                <span class="badge badge-light"><h4>Tell us something about youself:</h4></span>
                <textarea type="text" placeholder="  Add your profile text? " style="font-size:18pt;height:90px;width:100%;" name="add_profile_text"></textarea>
                <button type="submit" class="btn btn-secondary" name="btn" value="add_profile_text">ADD</button><br><br>
                <h3>&#160OR</h3><br>
            {% endif %}  
            
            {% if new_status == True %}
            <div class="alert alert-info" role="alert">
                Your have successfully posted a status!
            </div>
            {% elif new_status == "empty" %}
            <div class="alert alert-warning" role="alert">
                Cannot post an empty status!
            </div>
            {% elif new_status == "deleted" %}
            <div class="alert alert-warning" role="alert">
                You have successfully deleted a post!
            </div>
            {% endif %}
            
            {% if page_zid == zid %}
            <span class="badge badge-info"><h4>Type something and post:</h4></span>
            <textarea type="text" placeholder="  What's on your mind?" style="font-size:18pt;height:90px;width:100%;" name="post_text"></textarea>
            <hr >
            <button type="submit" class="btn btn-secondary" name="btn" value="post">POST</button>
            {% endif %}
        </div>

        
        {% if posts %}
        <ul class="list-group">
            {% set count = [0] %}{% set vars = {'li': False} %}{% set vars = {'div': False} %}
            {% for time, msg in posts.items()  %}
                {% set vars = {'poster': None} %}
                {% if msg is mapping %}
                    {% for time_x, msg_x in msg.items()  %}
                        {{open_li}}
                        {% if msg_x is mapping %}
                            {% if ( (count[0] is greaterthan(start)) and (count[0] is lessthan(end)) ) %}
                                {% for time_x_x, msg_x_x in msg_x.items() %}
                                    {% if msg_x_x is mapping %}
                                        {% for id, msg_x_x_x in msg_x_x.items() %}

                                                    <h6>&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                                    {% if id in no_pic %}
                                                        <a  href="{{url_for('profile',login_zid=zid,zids=id)}}"><img src="/static/no_pic.png" width="30" height="30"></a>
                                                    {% else %}
                                                        <a  href="{{url_for('profile',login_zid=zid,zids=id)}}"><img src="/static/{{id}}.jpg" width="30" height="30"></a>
                                                    {% endif %}
                                                    &nbsp <a href="{{url_for('profile',login_zid=zid,zids=id)}}">{{ details[id]['full_name'] }}:</h6></a>
                                                    <p style="margin-left: 60px;">{{ msg_x_x_x | safe}}</p>
                                                <p style="margin-left: 60px;"><i><u>{{time_x_x}}</i></u>&nbsp&nbsp
                                                {% if zid == id %}
                                                <button type="submit" class="btn btn-sm btn-outline-warning" name="btn" value="delete_{{time}}_{{time_x}}_{{time_x_x}}_{{vars.poster}}">Delete Reply</button>
                                                {% endif %}
                                                </p>
                                        {% endfor %}
                                    {% else %}
                                            <h5>&nbsp&nbsp
                                            {% if time_x_x in no_pic %}
                                                <a  href="{{url_for('profile',login_zid=zid,zids=time_x_x)}}"><img src="/static/no_pic.png" width="40" height="40"></a>
                                            {% else %}
                                                <a  href="{{url_for('profile',login_zid=zid,zids=time_x_x)}}"><img src="/static/{{time_x_x}}.jpg" width="40" height="40"></a>
                                            {% endif %}
                                            &nbsp <a href="{{url_for('profile',login_zid=zid,zids=time_x_x)}}">{{ details[time_x_x]['full_name'] }}:</h5></a>
                                            <p style="margin-left: 20px;">{{ msg_x_x | safe}}</p>
                                        <p style="margin-left: 20px;"><i><u>{{time_x}}</i></u>&nbsp&nbsp
                                        <button type="submit" class="btn btn-sm btn-outline-primary" name="btn" value="reply_{{time}}_{{time_x}}_{{vars.poster}}">Reply</button>
                                        {% if zid == time_x_x %}
                                        <button type="submit" class="btn btn-sm btn-outline-warning" name="btn" value="delete_{{time}}_{{time_x}}__{{vars.poster}}">Delete Comment</button>
                                        {% endif %}
                                        <textarea type="text" placeholder=" Reply {{ details[time_x_x]['full_name'] }}?" style="font-size:10pt;height:40px;width:100%;" name="reply_{{time}}_{{time_x}}_{{vars.poster}}"></textarea>
                                        </p>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        {% else %}
                            {% if count.append(count.pop() + 1) %}{% endif %}
                            {% if ( (count[0] is greaterthan(start)) and (count[0] is lessthan(end)) ) %}
                                    {#{count[0]}#}
                                    {% if count[0] != 1 %}
                                    <nav class="navbar navbar-expand-md bg-dark" ></nav>
                                    {% endif %}
                                    {% if vars.update({'li': True}) %} {% endif %}
                                    
                                    <li class="list-group-item">
                                            <h4>&nbsp&nbsp
                                            {% if time_x in no_pic %}
                                                <a  href="{{url_for('profile',login_zid=zid,zids=time_x)}}"><img src="/static/no_pic.png" width="50" height="50"></a>
                                            {% else %}
                                                <a  href="{{url_for('profile',login_zid=zid,zids=time_x)}}"><img src="/static/{{time_x}}.jpg" width="50" height="50"></a>
                                            {% endif %}
                                            &nbsp<a  href="{{url_for('profile',login_zid=zid,zids=time_x)}}">{{ details[time_x]['full_name'] }}:</h4></a>
                                            <p style="margin-left: 20px;">{{ msg_x | safe}}</p>
                                            {% if vars.update({'poster': time_x}) %} {% endif %}
                                        <p style="margin-left: 20px;"><i> {{time}} </i>&nbsp&nbsp
                                        <button type="submit" class="btn btn-sm btn-outline-info" name="btn" value="comment_{{time}}_{{time_x}}">Comment</button>
                                        {% if zid == time_x %}
                                        <button type="submit" class="btn btn-sm btn-outline-warning" name="btn" value="delete_{{time}}___{{time_x}}">Delete Post</button><br><br>
                                        {% endif %}
                                        <textarea type="text" placeholder=" Add some comments?" style="font-size:10pt;height:50px;width:100%;" name="comment_{{time}}_{{time_x}}"></textarea>
                                        </p>
                                        <hr>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                    {% if vars.li == True %}
                        </li>
                        {% if vars.update({'li': False}) %} {% endif %}
                    {% endif %}
                {% endif %}
            {% else %}
                <h2>Cannot find any post!</h2>
            {% endfor %}
        

        
        <nav class="navbar navbar-expand-md bg-dark justify-content-between" >
        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups" >
            <div class="btn-group btn-group-lg" role="group" aria-label="First group">
            <form method="POST" >
            
            {% set pages =  (((n_posts-1)/10) + 2) %}
            {% for j in range( 1,  pages | round(0,'floor') | int ) %}
                <button type="submit" class="btn btn-secondary" name="btn" value="p{{j}}">{{j}}</button>
            {% endfor %}
            {% set curr = (end-1)/10 %}
            {% set pages =  pages - 1 %}
            <font size="4" color="#1E90FF">
                &#160&#160 <u>Page: {{ curr | round |int }}/{{ pages | round(0,'floor') |int }}</u>
            </font>
            </form>
            </div>
        </div>
        </nav>

        {% endif %}
        </form>
   </body>
</html>
