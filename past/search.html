<!doctype html>
<html>
    <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <link rel="shortcut icon" href="static/favicon.ico" />
    <title>UNSWtalk</title>
    </head>
    <body>
        <form method="POST">
                <nav class="navbar navbar-expand-md fixed-top navbar-dark bg-dark justify-content-between" >

            <a class="navbar-brand" href="{{url_for('index',login_zid=zid)}}"><h3>UNSWtalk</h3></a>

            <div class="form-inline">
                <a class="navbar-brand" href="{{url_for('profile',login_zid=zid,zids=zid)}}"> 
                    &#160&#160&#160&#160&#160
                    {% if zid in no_pic %}
                    <img src="/static/no_pic.png" width="40" height="40">
                    {% else %}
                    <img src="/static/{{zid}}.jpg" width="40" height="40">
                    {% endif %}
                </a>
                <a class="navbar-brand" href="{{url_for('profile',login_zid=zid,zids=zid)}}"> {{ details[zid]['full_name'] }} &#160 </a>
                <a class="navbar-brand" href="{{url_for('friend_page',login_zid=zid)}}"> Friends </a>
                <a class="navbar-brand" href="{{url_for('friend_suggestions',login_zid=zid)}}"> Friend Suggestions </a>
                <a class="navbar-brand" href="https://www.patreon.com/"> Support Us </a>
            </div>
            <div class="form-inline">
                <input class="form-control" type="text" placeholder="Search names or posts" aria-label="Search" name="search" size="50">
                <span class="input-group-btn">
                    <button class="btn btn-secondary" type="submit" name="btn" value="s_name">&#x1F50E Name</button>
                </span>
                <span class="input-group-btn">
                    <button class="btn btn-secondary" type="submit" name="btn" value="s_post">&#x1F50E Post</button>
                </span>
            </div>
                <button type="submit" class="btn btn-warning" name="btn" value="logout">Logout</button>

        </nav>
        <br><br>
        <br>
        {% if new_status == True %}
            <div class="alert alert-info" role="alert">
                Your have successfully posted a comment!
            </div>
            {% elif new_status == "empty" %}
            <div class="alert alert-warning" role="alert">
                Cannot post an empty comment!
            </div>
            {% elif new_status == "deleted" %}
            <div class="alert alert-warning" role="alert">
                You have successfully deleted a comment!
            </div>
        {% endif %}
        
        {% if err_msg %}
            <h2>{{err_msg}}</h2>
        {% else %}
            <h2>&nbsp&nbsp Looking for: "{{search_field}}"<br>
            &nbsp&nbsp Number of results found: {{n_results}}</h2>
        {% endif %}    
        {% if found %}    
        
        {% if by_method == "name" %}
        
        <ul class="list-group">
            {% set count = [0] %}
            {% for ids,match in found.items() %}
            {% if count.append(count.pop() + 1) %}{% endif %}
                {% if ( (count[0] is greaterthan(start)) and (count[0] is lessthan(end)) ) %}
                    <li class="list-group-item">
                        <h4>
                        {% if ids in no_pic %}
                            <a  href="{{url_for('profile',login_zid=zid,zids=ids)}}"><img src="/static/no_pic.png" width="50" height="50"></a>
                        {% else %}
                            <a  href="{{url_for('profile',login_zid=zid,zids=ids)}}"><img src="/static/{{ids}}.jpg" width="50" height="50"></a>
                        {% endif %}
                        &nbsp <a  href="{{url_for('profile',login_zid=zid,zids=ids)}}">{{ details[ids]['full_name'] }}</a><br></h4>
                        <h6><font color="grey"><i>&nbsp matching: {{ match['match'] | safe }}</i></font><h6>
                        {% if ids in friends[zid] %}
                        <div align="right">
                            <button class="btn btn-primary btn disabled" >Already added as friend</button>
                        </div>
                        {% else %}
                        <div align="right">
                            <button type="submit" class="btn btn-primary btn" name="btn" value="addfriend_{{ids}}">Add as friend</button>
                        </div>
                        {% endif %}
                    </li>
                {% endif %}    
            {% endfor %}
        </ul>
        {% elif by_method == "post" %}
            {% set count = [0] %}
            {% for time, dict in found.items() %}
                {% if count.append(count.pop() + 1) %}{% endif %}
                {% if ( (count[0] is greaterthan(start)) and (count[0] is lessthan(end)) ) %}
                {% if dict['zid'] %}
                    <li class="list-group-item">
                        <h4>
                        {% if dict['zid'] in no_pic %}
                            <a  href="{{url_for('profile',login_zid=zid,zids=dict['zid'])}}"><img src="/static/no_pic.png" width="50" height="50"></a>
                        {% else %}
                            <a  href="{{url_for('profile',login_zid=zid,zids=dict['zid'])}}"><img src="/static/{{dict['zid']}}.jpg" width="50" height="50"></a>
                        {% endif %}
                        &nbsp <a  href="{{url_for('profile',login_zid=zid,zids=dict['zid'])}}">{{ details[dict['zid']]['full_name'] }}</a><br></h4>
                        <p style="margin-left: 20px;">{{ dict['match'] | safe }}</p>
                        <p style="margin-left: 20px;"><i> {{dict['time']}} </i>&nbsp&nbsp
                        <button type="submit" class="btn btn-sm btn-outline-info" name="btn" value="comment_{{dict['time']}}_{{dict['zid']}}">Comment</button>
                        {% if dict['zid'] == zid %}
                        <button type="submit" class="btn btn-sm btn-outline-warning" name="btn" value="delete_{{dict['time']}}_{{dict['zid']}}">Delete Post</button><br><br>
                        {% endif %}
                        <textarea type="text" placeholder=" Add some comments?" style="font-size:10pt;height:50px;width:100%;" name="comment_{{dict['time']}}_{{dict['zid']}}"></textarea>
                        </p>
                    </li>
                {% endif %}
                {% endif %}
            {% endfor %}
        {% endif %}        
        <nav class="navbar navbar-expand-md bg-dark justify-content-between" >
        <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups" >
            <div class="btn-group btn-group-lg" role="group" aria-label="First group">
            <form method="POST" >
            
        {% if n_results > 0 %}
            {% set pages =  (((n_results-1)/10) + 2) %}
            {% for j in range( 1,  pages | round( 0 ,'floor') | int ) %}
                <button type="submit" class="btn btn-secondary" name="btn" value="p{{j}}">{{j}}</button>
            {% endfor %}
            {% set curr = (end-1)/10 %}
            {% set pages =  pages - 1 %}
            <font size="4" color="#1E90FF">
                &#160&#160 <u>Page: {{ curr | round |int }}/{{ pages | round(0,'floor') |int }}</u>
            </font>
        {% else %}
            <button type="button" class="btn btn-secondary" name="btn" value="p1">1</button>
            <font size="4" color="#1E90FF">
                &#160&#160 <u>Page: 1/1 </u>
            </font>
        {% endif %}
            </form>
            </div>
        </div>
        </nav>
        {% endif %}
        </form>
   </body>
</html>
